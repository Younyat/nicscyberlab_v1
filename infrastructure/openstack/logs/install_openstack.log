[2025-12-09 21:24:06] Iniciando comprobación de permisos
[2025-12-09 21:24:06] ERROR: Este script no debe ejecutarse como root.
[2025-12-09 21:28:07] Iniciando comprobación de permisos
[2025-12-09 21:28:07] Usuario ejecutor: nics (UID=1000)
[2025-12-09 21:28:07] Grupos: nics adm cdrom sudo dip plugdev users lpadmin
[2025-12-09 21:28:07] Permisos sudo verificados correctamente
[2025-12-09 21:28:07] Instalando dependencias del sistema
[2025-12-09 21:29:04] Dependencias del sistema instaladas correctamente
[2025-12-09 21:29:07] Configurando repositorio de Docker
[2025-12-09 21:29:30] Docker instalado. Habilitando servicio y agregando usuario al grupo docker
[2025-12-09 21:29:32] Creando entorno virtual en /home/nics/openstack_venv
[2025-12-09 21:29:44] Entorno virtual activado: /home/nics/openstack_venv/bin/python
[2025-12-09 21:29:44] Instalando dependencias Python para Kolla-Ansible desde /home/nics/Desktop/nicscyberlab_v1/infrastructure/openstack/configs/requirements-kolla.txt
[2025-12-09 21:31:08] Dependencias Python y Kolla-Ansible instaladas correctamente
[2025-12-09 21:31:08] Configurando Kolla en /etc/kolla
[2025-12-09 21:31:08] Generando passwords de Kolla
[2025-12-09 21:31:12] Detectando interfaz principal y subnet para VIP
[2025-12-09 21:31:13] Interfaz principal: ens34
[2025-12-09 21:31:13] IP principal:       192.168.0.195
[2025-12-09 21:31:13] VIP seleccionada:   192.168.0.12
[2025-12-09 21:31:13] Generando /etc/kolla/globals.yml desde plantilla
[2025-12-09 21:31:13] Archivo globals.yml configurado correctamente
[2025-12-09 21:31:13] === Iniciando configuración + despliegue de OpenStack con Kolla-Ansible ===
[2025-12-09 21:31:13] Activando entorno virtual: /home/nics/openstack_venv
[2025-12-09 21:31:13] globals.yml y passwords.yml ya existen. No se sobrescriben.
[2025-12-09 21:31:13] Verificando passwords...
[2025-12-09 21:31:13] passwords.yml ya contiene contraseñas válidas
[2025-12-09 21:31:13] Detectando interfaz principal y generando VIP
[2025-12-09 21:31:14] Interfaz principal detectada: ens34
[2025-12-09 21:31:14] IP principal:                192.168.0.195
[2025-12-09 21:31:14] VIP seleccionado:            192.168.0.200
[2025-12-09 21:31:14] Generando archivo globals.yml final
[2025-12-09 21:31:14] globals.yml configurado correctamente
[2025-12-09 21:31:14] Creando inventario all-in-one
[2025-12-09 21:31:14] Instalando dependencias Galaxy
Your branch is up to date with 'origin/master'.
Starting galaxy collection install process
Process install dependency map
Starting collection install process
Installing 'openstack.kolla:1.0.0' to '/home/nics/.ansible/collections/ansible_collections/openstack/kolla'
Created collection for openstack.kolla:1.0.0 at /home/nics/.ansible/collections/ansible_collections/openstack/kolla
openstack.kolla:1.0.0 was installed successfully
Starting galaxy collection install process
Process install dependency map
Starting collection install process
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/ansible-posix-2.1.0.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/ansible-posix-2.1.0-rmivvegp
Installing 'ansible.posix:2.1.0' to '/home/nics/.ansible/collections/ansible_collections/ansible/posix'
ansible.posix:2.1.0 was installed successfully
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/ansible-utils-6.0.0.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/ansible-utils-6.0.0-11ndycy5
Installing 'ansible.utils:6.0.0' to '/home/nics/.ansible/collections/ansible_collections/ansible/utils'
ansible.utils:6.0.0 was installed successfully
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/ansible-netcommon-8.2.0.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/ansible-netcommon-8.2.0-nrulafww
Installing 'ansible.netcommon:8.2.0' to '/home/nics/.ansible/collections/ansible_collections/ansible/netcommon'
ansible.netcommon:8.2.0 was installed successfully
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/containers-podman-1.18.0.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/containers-podman-1.18.0-42ebl870
Installing 'containers.podman:1.18.0' to '/home/nics/.ansible/collections/ansible_collections/containers/podman'
containers.podman:1.18.0 was installed successfully
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/community-crypto-3.0.5.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/community-crypto-3.0.5-5k2jjb7u
Installing 'community.crypto:3.0.5' to '/home/nics/.ansible/collections/ansible_collections/community/crypto'
community.crypto:3.0.5 was installed successfully
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/community-docker-4.8.5.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/community-docker-4.8.5-40ajqvig
Installing 'community.docker:4.8.5' to '/home/nics/.ansible/collections/ansible_collections/community/docker'
community.docker:4.8.5 was installed successfully
'community.library_inventory_filtering_v1:1.1.1' is already installed, skipping.
Downloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/community-general-11.4.2.tar.gz to /home/nics/.ansible/tmp/ansible-local-19801bitsylje/tmp587sjm60/community-general-11.4.2-2qej25p0
Installing 'community.general:11.4.2' to '/home/nics/.ansible/collections/ansible_collections/community/general'
community.general:11.4.2 was installed successfully
[2025-12-09 21:31:58] Ejecutando bootstrap-servers

PLAY [Gather facts for all hosts] **********************************************

TASK [Group hosts to determine when using --limit] *****************************
ok: [localhost]

TASK [Gather facts] ************************************************************
ok: [localhost]

PLAY [Gather facts for all hosts (if using --limit)] ***************************
skipping: no hosts matched

PLAY [Apply role baremetal] ****************************************************

TASK [openstack.kolla.etc_hosts : Include etc-hosts.yml] ***********************
included: /home/nics/.ansible/collections/ansible_collections/openstack/kolla/roles/etc_hosts/tasks/etc-hosts.yml for localhost

TASK [openstack.kolla.etc_hosts : Ensure localhost in /etc/hosts] **************
ok: [localhost]

TASK [openstack.kolla.etc_hosts : Ensure hostname does not point to 127.0.1.1 in /etc/hosts] ***
changed: [localhost]

TASK [openstack.kolla.etc_hosts : Generate /etc/hosts for all of the nodes] ****
changed: [localhost]

TASK [openstack.kolla.etc_hosts : Check whether /etc/cloud/cloud.cfg exists] ***
ok: [localhost]

TASK [openstack.kolla.etc_hosts : Disable cloud-init manage_etc_hosts] *********
changed: [localhost]

TASK [openstack.kolla.baremetal : Ensure unprivileged users can use ping] ******
skipping: [localhost]

TASK [openstack.kolla.baremetal : Set firewall default policy] *****************
ok: [localhost]

TASK [openstack.kolla.baremetal : Check if firewalld is installed] *************
skipping: [localhost]

TASK [openstack.kolla.baremetal : Disable firewalld] ***************************
skipping: [localhost] => (item=firewalld) 
skipping: [localhost]

TASK [openstack.kolla.packages : Install packages] *****************************
ok: [localhost]

TASK [openstack.kolla.packages : Remove packages] ******************************
ok: [localhost]

TASK [openstack.kolla.docker : Install/Uninstall] ******************************
included: /home/nics/.ansible/collections/ansible_collections/openstack/kolla/roles/docker/tasks/install.yml for localhost

TASK [openstack.kolla.docker : Enable Docker repository] ***********************
included: /home/nics/.ansible/collections/ansible_collections/openstack/kolla/roles/docker/tasks/repo-Debian.yml for localhost

TASK [openstack.kolla.docker : Install CA certificates and gnupg packages] *****
ok: [localhost]

TASK [openstack.kolla.docker : Ensure apt sources list directory exists] *******
ok: [localhost]

TASK [openstack.kolla.docker : Ensure apt keyrings directory exists] ***********
ok: [localhost]

TASK [openstack.kolla.docker : Install docker apt gpg key] *********************
changed: [localhost]

TASK [openstack.kolla.docker : Install docker apt pin] *************************
skipping: [localhost]

TASK [openstack.kolla.docker : Ensure old docker repository absent] ************
changed: [localhost]

TASK [openstack.kolla.docker : Enable docker apt repository] *******************
changed: [localhost]

TASK [openstack.kolla.docker : Update the apt cache] ***************************
changed: [localhost]

TASK [openstack.kolla.docker : Check which containers are running] *************
ok: [localhost]

TASK [openstack.kolla.docker : Check if docker systemd unit exists] ************
ok: [localhost]

TASK [openstack.kolla.docker : Mask the docker systemd unit on Debian/Ubuntu] ***
changed: [localhost]

TASK [openstack.kolla.docker : Install packages] *******************************
ok: [localhost]

TASK [openstack.kolla.docker : Start docker] ***********************************
skipping: [localhost]

TASK [openstack.kolla.docker : Wait for Docker to start] ***********************
skipping: [localhost]

TASK [openstack.kolla.docker : Ensure containers are running after Docker upgrade] ***
skipping: [localhost]

TASK [openstack.kolla.docker : Ensure docker config directory exists] **********
ok: [localhost]

TASK [openstack.kolla.docker : Write docker config] ****************************
changed: [localhost]

TASK [openstack.kolla.docker : Flush handlers] *********************************

RUNNING HANDLER [openstack.kolla.docker : Restart docker] **********************
changed: [localhost]

TASK [openstack.kolla.docker : Get Docker API version] *************************
ok: [localhost]

TASK [openstack.kolla.docker : Parse Docker system info] ***********************
ok: [localhost]

TASK [openstack.kolla.docker : Determine if Docker uses containerd image store] ***
ok: [localhost]

TASK [openstack.kolla.docker : Copying over containerd config] *****************
changed: [localhost]

TASK [openstack.kolla.docker : Remove old docker options file] *****************
ok: [localhost]

TASK [openstack.kolla.docker : Ensure docker service directory exists] *********
skipping: [localhost]

TASK [openstack.kolla.docker : Configure docker service] ***********************
skipping: [localhost]

TASK [openstack.kolla.docker : Ensure the path for CA file for private registry exists] ***
skipping: [localhost]

TASK [openstack.kolla.docker : Ensure the CA file for private registry exists] ***
skipping: [localhost]

TASK [openstack.kolla.docker : Flush handlers] *********************************

RUNNING HANDLER [openstack.kolla.docker : Restart containerd] ******************
changed: [localhost]

TASK [openstack.kolla.docker : Start and enable docker] ************************
ok: [localhost]

TASK [openstack.kolla.docker : Configure containerd for Zun] *******************
skipping: [localhost]

TASK [openstack.kolla.kolla_user : Ensure groups are present] ******************
skipping: [localhost] => (item=docker) 
skipping: [localhost] => (item=sudo) 
skipping: [localhost] => (item=kolla) 
skipping: [localhost]

TASK [openstack.kolla.kolla_user : Create kolla user] **************************
skipping: [localhost]

TASK [openstack.kolla.kolla_user : Add public key to kolla user authorized keys] ***
skipping: [localhost]

TASK [openstack.kolla.kolla_user : Grant kolla user passwordless sudo] *********
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Get Python] *********************************
ok: [localhost]

TASK [openstack.kolla.docker_sdk : Check if Python environment is externally managed] ***
ok: [localhost]

TASK [openstack.kolla.docker_sdk : Set docker_sdk_python_externally_managed fact] ***
ok: [localhost]

TASK [openstack.kolla.docker_sdk : Install/Uninstall] **************************
included: /home/nics/.ansible/collections/ansible_collections/openstack/kolla/roles/docker_sdk/tasks/install.yml for localhost

TASK [openstack.kolla.docker_sdk : Ensure apt sources list directory exists] ***
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Ensure apt keyrings directory exists] *******
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Install osbpo apt gpg key] ******************
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Enable osbpo apt repository] ****************
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Install packages] ***************************
changed: [localhost]

TASK [openstack.kolla.docker_sdk : Check if virtualenv is a directory] *********
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Check if packaging is already installed] ****
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Install packaging into virtualenv] **********
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Install latest pip and packaging in the virtualenv] ***
skipping: [localhost]

TASK [openstack.kolla.docker_sdk : Install docker SDK for python using pip] ****
skipping: [localhost]

TASK [openstack.kolla.baremetal : Ensure node_config_directory directory exists] ***
ok: [localhost]

TASK [openstack.kolla.apparmor_libvirt : Include tasks from remove-profile.yml] ***
included: /home/nics/.ansible/collections/ansible_collections/openstack/kolla/roles/apparmor_libvirt/tasks/remove-profile.yml for localhost

TASK [openstack.kolla.apparmor_libvirt : Get stat of libvirtd apparmor profile] ***
ok: [localhost]

TASK [openstack.kolla.apparmor_libvirt : Get stat of libvirtd apparmor disable profile] ***
ok: [localhost]

TASK [openstack.kolla.apparmor_libvirt : Remove apparmor profile for libvirt] ***
skipping: [localhost]

TASK [openstack.kolla.baremetal : Change state of selinux] *********************
skipping: [localhost]

TASK [openstack.kolla.baremetal : Set https proxy for git] *********************
skipping: [localhost]

TASK [openstack.kolla.baremetal : Set http proxy for git] **********************
skipping: [localhost]

TASK [openstack.kolla.baremetal : Copying over kolla.target] *******************
changed: [localhost]

TASK [openstack.kolla.baremetal : Configure ceph for zun] **********************
skipping: [localhost]

PLAY RECAP *********************************************************************
localhost                  : ok=44   changed=14   unreachable=0    failed=0    skipped=30   rescued=0    ignored=0   

[2025-12-09 21:32:44] Ejecutando prechecks

PLAY [Gather facts for all hosts] **********************************************

TASK [Group hosts to determine when using --limit] *****************************
ok: [localhost]

TASK [Gather facts] ************************************************************
ok: [localhost]

PLAY [Gather facts for all hosts (if using --limit)] ***************************
skipping: no hosts matched

PLAY [Group hosts based on configuration] **************************************

TASK [Group hosts based on Kolla action] ***************************************
ok: [localhost]

TASK [Group hosts based on enabled services] ***********************************
ok: [localhost] => (item=enable_aodh_False)
ok: [localhost] => (item=enable_barbican_False)
ok: [localhost] => (item=enable_blazar_False)
ok: [localhost] => (item=enable_ceilometer_False)
ok: [localhost] => (item=enable_ceph_rgw_False)
ok: [localhost] => (item=enable_cinder_False)
ok: [localhost] => (item=enable_cloudkitty_False)
ok: [localhost] => (item=enable_collectd_False)
ok: [localhost] => (item=enable_cyborg_False)
ok: [localhost] => (item=enable_designate_False)
ok: [localhost] => (item=enable_etcd_False)
ok: [localhost] => (item=enable_fluentd_True)
ok: [localhost] => (item=enable_glance_True)
ok: [localhost] => (item=enable_gnocchi_False)
ok: [localhost] => (item=enable_grafana_False)
ok: [localhost] => (item=enable_hacluster_False)
ok: [localhost] => (item=enable_heat_True)
ok: [localhost] => (item=enable_horizon_True)
ok: [localhost] => (item=enable_influxdb_False)
ok: [localhost] => (item=enable_ironic_False)
ok: [localhost] => (item=enable_iscsid_False)
ok: [localhost] => (item=enable_keystone_True)
ok: [localhost] => (item=enable_kuryr_False)
ok: [localhost] => (item=enable_letsencrypt_False)
ok: [localhost] => (item=enable_loadbalancer_True)
ok: [localhost] => (item=enable_magnum_False)
ok: [localhost] => (item=enable_manila_False)
ok: [localhost] => (item=enable_mariadb_True)
ok: [localhost] => (item=enable_masakari_False)
ok: [localhost] => (item=enable_memcached_True)
ok: [localhost] => (item=enable_mistral_False)
ok: [localhost] => (item=enable_multipathd_False)
ok: [localhost] => (item=enable_neutron_True)
ok: [localhost] => (item=enable_nova_True)
ok: [localhost] => (item=enable_octavia_False)
ok: [localhost] => (item=enable_opensearch_False)
ok: [localhost] => (item=enable_opensearch_dashboards_False)
ok: [localhost] => (item=enable_openvswitch_True_enable_ovs_dpdk_False)
ok: [localhost] => (item=enable_ovn_False)
ok: [localhost] => (item=enable_placement_True)
ok: [localhost] => (item=enable_prometheus_False)
ok: [localhost] => (item=enable_rabbitmq_True)
ok: [localhost] => (item=enable_valkey_False)
ok: [localhost] => (item=enable_skyline_False)
ok: [localhost] => (item=enable_tacker_False)
ok: [localhost] => (item=enable_telegraf_False)
ok: [localhost] => (item=enable_trove_False)
ok: [localhost] => (item=enable_watcher_False)
ok: [localhost] => (item=enable_zun_False)

PLAY [Apply role prechecks] ****************************************************

TASK [prechecks : Checking loadbalancer group] *********************************
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [prechecks : include_tasks] ***********************************************
included: /home/nics/openstack_venv/share/kolla-ansible/ansible/roles/prechecks/tasks/host_os_checks.yml for localhost

TASK [prechecks : Checking host OS distribution] *******************************
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [prechecks : Checking host OS release or version] *************************
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [prechecks : Checking if CentOS is Stream] ********************************
skipping: [localhost]

TASK [prechecks : Fail if not running on CentOS Stream] ************************
skipping: [localhost]

TASK [prechecks : include_tasks] ***********************************************
skipping: [localhost]

TASK [prechecks : Ensure /etc/localtime exist] *********************************
ok: [localhost]

TASK [prechecks : Fail if /etc/localtime is absent] ****************************
skipping: [localhost]

TASK [prechecks : Ensure /etc/timezone exist] **********************************
ok: [localhost]

TASK [prechecks : Fail if /etc/timezone is absent] *****************************
skipping: [localhost]

TASK [prechecks : include_tasks] ***********************************************
skipping: [localhost]

TASK [prechecks : Checking if system uses systemd] *****************************
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [prechecks : Checking Docker version] *************************************
ok: [localhost]

TASK [prechecks : Checking empty passwords in passwords.yml. Run kolla-genpwd if this task fails] ***
ok: [localhost]

TASK [prechecks : Check if nscd is running] ************************************
ok: [localhost]

TASK [prechecks : Fail if nscd is running] *************************************
skipping: [localhost]

TASK [prechecks : Validate that internal and external vip address are different when TLS is enabled only on either the internal and external network] ***
skipping: [localhost]

TASK [prechecks : Validate that enable_ceph is disabled] ***********************
skipping: [localhost]

TASK [prechecks : Validate that enable_redis is disabled] **********************
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [prechecks : Checking docker SDK version] *********************************
ok: [localhost]

TASK [prechecks : Checking dbus-python package] ********************************
fatal: [localhost]: FAILED! => {"changed": false, "cmd": ["/home/nics/openstack_venv/bin/python3.12", "-c", "import dbus"], "delta": "0:00:00.023520", "end": "2025-12-09 21:32:51.930621", "failed_when_result": true, "msg": "non-zero return code", "rc": 1, "start": "2025-12-09 21:32:51.907101", "stderr": "Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nModuleNotFoundError: No module named 'dbus'", "stderr_lines": ["Traceback (most recent call last):", "  File \"<string>\", line 1, in <module>", "ModuleNotFoundError: No module named 'dbus'"], "stdout": "", "stdout_lines": []}

PLAY RECAP *********************************************************************
localhost                  : ok=16   changed=0    unreachable=0    failed=1    skipped=9    rescued=0    ignored=0   

